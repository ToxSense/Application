# Learning Atmospheres - ToxSense 

## Smartphone

A modern smartphone contains a lot of hardware, mostly everybody carries. To base on this already set technology, the ToxSense application uses different inbuilt functions, like the bluetooth chip, the internet access and the possibility to interact on a visual base. The application is written in the programm-languages Kotlin and Java, which are used in the Android Studio Editor. The visual layout is based on xml files. The whole program is split into four activities. The first is the main activity, which is used as the root frame, the other activities are built on. If this activity is stopped, the application closes. From there on it is possible to switch between the other activities, by closing and reopening them. The automatically opened first activity is the Home screen. It contains the whole automated process of connecting to the headband, querying the GPS location and handling the server post and response functions as well as the picture to aqi value through an AI. As the first step in this process, the application tries to open a bluetooth serial connection to the headband, if it succeeds an info is displayed saying “bluetooth opened”, else an error occurs. Meanwhile a parallel function reaches for the user location. By updating the location, a command to the headband device is sent, requesting a picture. A bluetooth listener, working similar as the one mentioned on the ESP32-CAM module, detects an incoming, encoded picture. This gets decoded and passed to the AI which finally calculates an air quality index, based on a TensorFlow-Lite-Model. Together with the location and the picture itself, the AQI is sent to the server via a http post request. As response, the server provides a json dictionary, containing surrounding AQI values and an info text. This again gets transmitted to the headband as a string.

Another activity contains only functions for the bluetooth connection, with an entry label and an open, send and close button. This activity is mainly used for debug purposes regarding the headband and its serial connection. The last activity aims at the usage of the tflite model. There the smartphone camera is activated and creates a picture stream continuously interpreted by the AI into an air quality index. This index is simply shown beneath the camera frame, making it possible to detect the local air quality in an instant, even without the use of a headband. To maintain the functionality of the application, it has to request permissions for the bluetooth connection, the access to the location, the internet connection and the camera permission. Those permissions are set in the application manifest file.

## Credits

This project is imagined and created by Timo Bilhöfer, Markus Pfaff and Maria Rădulescu.

As part of the seminar *Learning Atmospheres* in the winter-semester 2020/21 it is supported by Irina Auernhammer, Silas Kalmbach and Prof. Lucio Blandini from the[ Institute for Lightweight Structures and Conceptual Design (**ILEK**)](https://www.ilek.uni-stuttgart.de/) and is also part of the[ Collaborative Research Centre 1244 (**SFB 1244**)](https://www.sfb1244.uni-stuttgart.de/).